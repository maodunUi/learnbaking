<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cn.ymt.dao.CourseDao">

<sql id="Simple_Column">
 select
 course.id as course_id,
 course.video_url as course_video_url,
 course.title as course_title,
 course.img_url as course_img_url,
 course.memo as course_memo,
 course.memo_two as course_memo_two,
 course.how_learn as course_how_learn,
 course.baker_name as course_baker_name,
 course.backer_img_url as course_backer_img_url,
 course.bakers_introduce as course_bakers_introduce,
 course.price as course_price,
 course.people_count as course_people_count,
 course.add_time as course_add_time,
 course.order_index as course_order_index,
 course.state as course_state,
 course.category_id as course_category_id,
 course.isindex as course_isindex
 from course as course 
</sql>

<sql id="Base_Column">
 select
 course.id as course_id,
 course.video_url as course_video_url,
 course.title as course_title,
 course.img_url as course_img_url,
 course.memo as course_memo,
 course.memo_two as course_memo_two,
 course.how_learn as course_how_learn,
 course.baker_name as course_baker_name,
 course.backer_img_url as course_backer_img_url,
 course.bakers_introduce as course_bakers_introduce,
 course.price as course_price,
 course.people_count as course_people_count,
 course.add_time as course_add_time,
 course.order_index as course_order_index,
 course.state as course_state,
 course.category_id as course_category_id,
 course.isindex as course_isindex
 from course as course 
</sql>

<sql id="Detail_Column">
 select
 course.id as course_id,
 course.video_url as course_video_url,
 course.title as course_title,
 course.img_url as course_img_url,
 course.memo as course_memo,
 course.memo_two as course_memo_two,
 course.how_learn as course_how_learn,
 course.baker_name as course_baker_name,
 course.backer_img_url as course_backer_img_url,
 course.bakers_introduce as course_bakers_introduce,
 course.price as course_price,
 course.people_count as course_people_count,
 course.add_time as course_add_time,
 course.order_index as course_order_index,
 course.state as course_state,
 course.category_id as course_category_id,
 course.isindex as course_isindex
 from course as course 
</sql>

<resultMap id="SimpleResultMap" type="cn.ymt.view.simple.CourseSimpleView">
<id column="course_id" jdbcType="INTEGER" property="id" />
 <result column="course_video_url" jdbcType="VARCHAR" property="video_url" />
 <result column="course_title" jdbcType="VARCHAR" property="title" />
 <result column="course_img_url" jdbcType="VARCHAR" property="img_url" />
 <result column="course_memo" jdbcType="LONGVARCHAR" property="memo" />
 <result column="course_memo_two" jdbcType="LONGVARCHAR" property="memo_two" />
 <result column="course_how_learn" jdbcType="VARCHAR" property="how_learn" />
 <result column="course_baker_name" jdbcType="VARCHAR" property="baker_name" />
 <result column="course_backer_img_url" jdbcType="VARCHAR" property="backer_img_url" />
 <result column="course_bakers_introduce" jdbcType="VARCHAR" property="bakers_introduce" />
 <result column="course_price" jdbcType="DOUBLE" property="price" />
 <result column="course_people_count" jdbcType="INTEGER" property="people_count" />
 <result column="course_add_time" jdbcType="DATE" property="add_time" />
 <result column="course_order_index" jdbcType="TINYINT" property="order_index" />
 <result column="course_state" jdbcType="TINYINT" property="state" />
 <result column="course_category_id" jdbcType="INTEGER" property="category_id" />
 <result column="course_isindex" jdbcType="TINYINT" property="isindex" />
</resultMap>

<resultMap id="BaseResultMap" type="cn.ymt.view.CourseView">
<id column="course_id" jdbcType="INTEGER" property="id" />
 <result column="course_video_url" jdbcType="VARCHAR" property="video_url" />
 <result column="course_title" jdbcType="VARCHAR" property="title" />
 <result column="course_img_url" jdbcType="VARCHAR" property="img_url" />
 <result column="course_memo" jdbcType="LONGVARCHAR" property="memo" />
 <result column="course_memo_two" jdbcType="LONGVARCHAR" property="memo_two" />
 <result column="course_how_learn" jdbcType="VARCHAR" property="how_learn" />
 <result column="course_baker_name" jdbcType="VARCHAR" property="baker_name" />
 <result column="course_backer_img_url" jdbcType="VARCHAR" property="backer_img_url" />
 <result column="course_bakers_introduce" jdbcType="VARCHAR" property="bakers_introduce" />
 <result column="course_price" jdbcType="DOUBLE" property="price" />
 <result column="course_people_count" jdbcType="INTEGER" property="people_count" />
 <result column="course_add_time" jdbcType="DATE" property="add_time" />
 <result column="course_order_index" jdbcType="TINYINT" property="order_index" />
 <result column="course_state" jdbcType="TINYINT" property="state" />
 <result column="course_category_id" jdbcType="INTEGER" property="category_id" />
 <result column="course_isindex" jdbcType="TINYINT" property="isindex" />
</resultMap>

<resultMap id="DetailResultMap" type="cn.ymt.view.CourseView" extends="BaseResultMap">
</resultMap>

<delete id="deleteById" parameterType="java.lang.Integer">
delete from course where id = #{id,jdbcType=INTEGER}
</delete>

<delete id="deleteByIds">
delete from course
where <foreach collection="list" item="i" open="(" close=")" separator=" or "> id=#{i,jdbcType=INTEGER} </foreach>
  </delete>

<delete id="deleteObjects">
delete from course
where <foreach collection="list" item="i" open="(" close=")" separator=" or "> id=#{i.id,jdbcType=INTEGER} </foreach>
  </delete>

<delete id="deleteByParams" parameterType="cn.ymt.query.CourseQueryParams">
delete from course 
<where><if test="condition != null">${condition}</if></where>
</delete>

<insert id="save" parameterType="cn.ymt.view.CourseView" useGeneratedKeys="true" keyProperty="id">
insert into course (video_url,title,img_url,memo,memo_two,how_learn,baker_name,backer_img_url,bakers_introduce,price,people_count,add_time,order_index,state,category_id,isindex) 
 values(#{video_url,jdbcType=VARCHAR},#{title,jdbcType=VARCHAR},#{img_url,jdbcType=VARCHAR},#{memo,jdbcType=LONGVARCHAR},#{memo_two,jdbcType=LONGVARCHAR},#{how_learn,jdbcType=VARCHAR},#{baker_name,jdbcType=VARCHAR},#{backer_img_url,jdbcType=VARCHAR},#{bakers_introduce,jdbcType=VARCHAR},#{price,jdbcType=DOUBLE},#{people_count,jdbcType=INTEGER},#{add_time,jdbcType=DATE},#{order_index,jdbcType=TINYINT},#{state,jdbcType=TINYINT},#{category_id,jdbcType=INTEGER},#{isindex,jdbcType=TINYINT})
</insert>

<insert id="saveNoNull" parameterType="cn.ymt.view.CourseView" useGeneratedKeys="true" keyProperty="id">
insert into course
<trim prefix="(" suffix=")" suffixOverrides=",">
 <if test="video_url != null">
video_url,
</if>
 <if test="title != null">
title,
</if>
 <if test="img_url != null">
img_url,
</if>
 <if test="memo != null">
memo,
</if>
 <if test="memo_two != null">
memo_two,
</if>
 <if test="how_learn != null">
how_learn,
</if>
 <if test="baker_name != null">
baker_name,
</if>
 <if test="backer_img_url != null">
backer_img_url,
</if>
 <if test="bakers_introduce != null">
bakers_introduce,
</if>
 <if test="price != null">
price,
</if>
 <if test="people_count != null">
people_count,
</if>
 <if test="add_time != null">
add_time,
</if>
 <if test="order_index != null">
order_index,
</if>
 <if test="state != null">
state,
</if>
 <if test="category_id != null">
category_id,
</if>
 <if test="isindex != null">
isindex,
</if>
</trim>

<trim prefix="values(" suffix=")" suffixOverrides=",">
<if test="video_url != null">
#{video_url,jdbcType=VARCHAR},
</if>
<if test="title != null">
#{title,jdbcType=VARCHAR},
</if>
<if test="img_url != null">
#{img_url,jdbcType=VARCHAR},
</if>
<if test="memo != null">
#{memo,jdbcType=LONGVARCHAR},
</if>
<if test="memo_two != null">
#{memo_two,jdbcType=LONGVARCHAR},
</if>
<if test="how_learn != null">
#{how_learn,jdbcType=VARCHAR},
</if>
<if test="baker_name != null">
#{baker_name,jdbcType=VARCHAR},
</if>
<if test="backer_img_url != null">
#{backer_img_url,jdbcType=VARCHAR},
</if>
<if test="bakers_introduce != null">
#{bakers_introduce,jdbcType=VARCHAR},
</if>
<if test="price != null">
#{price,jdbcType=DOUBLE},
</if>
<if test="people_count != null">
#{people_count,jdbcType=INTEGER},
</if>
<if test="add_time != null">
#{add_time,jdbcType=DATE},
</if>
<if test="order_index != null">
#{order_index,jdbcType=TINYINT},
</if>
<if test="state != null">
#{state,jdbcType=TINYINT},
</if>
<if test="category_id != null">
#{category_id,jdbcType=INTEGER},
</if>
<if test="isindex != null">
#{isindex,jdbcType=TINYINT},
</if>
</trim>
</insert>

<insert id="saves" >
insert into course (video_url,title,img_url,memo,memo_two,how_learn,baker_name,backer_img_url,bakers_introduce,price,people_count,add_time,order_index,state,category_id,isindex) 
 values <foreach collection="list" item="obj" separator=",">(#{obj.video_url,jdbcType=VARCHAR},#{obj.title,jdbcType=VARCHAR},#{obj.img_url,jdbcType=VARCHAR},#{obj.memo,jdbcType=LONGVARCHAR},#{obj.memo_two,jdbcType=LONGVARCHAR},#{obj.how_learn,jdbcType=VARCHAR},#{obj.baker_name,jdbcType=VARCHAR},#{obj.backer_img_url,jdbcType=VARCHAR},#{obj.bakers_introduce,jdbcType=VARCHAR},#{obj.price,jdbcType=DOUBLE},#{obj.people_count,jdbcType=INTEGER},#{obj.add_time,jdbcType=DATE},#{obj.order_index,jdbcType=TINYINT},#{obj.state,jdbcType=TINYINT},#{obj.category_id,jdbcType=INTEGER},#{obj.isindex,jdbcType=TINYINT})</foreach>
</insert>
<update id="updateAll" parameterType="cn.ymt.view.CourseView">
update course 
set  video_url = #{video_url,jdbcType=VARCHAR}, title = #{title,jdbcType=VARCHAR}, img_url = #{img_url,jdbcType=VARCHAR}, memo = #{memo,jdbcType=LONGVARCHAR}, memo_two = #{memo_two,jdbcType=LONGVARCHAR}, how_learn = #{how_learn,jdbcType=VARCHAR}, baker_name = #{baker_name,jdbcType=VARCHAR}, backer_img_url = #{backer_img_url,jdbcType=VARCHAR}, bakers_introduce = #{bakers_introduce,jdbcType=VARCHAR}, price = #{price,jdbcType=DOUBLE}, people_count = #{people_count,jdbcType=INTEGER}, add_time = #{add_time,jdbcType=DATE}, order_index = #{order_index,jdbcType=TINYINT}, state = #{state,jdbcType=TINYINT}, category_id = #{category_id,jdbcType=INTEGER}, isindex = #{isindex,jdbcType=TINYINT} where id = #{id,jdbcType=INTEGER}
</update>
 <update id="updateNoNull" parameterType="cn.ymt.view.CourseView">
update course 
<set>
<if test="video_url != null"> video_url = #{video_url,jdbcType=VARCHAR},</if>
<if test="title != null"> title = #{title,jdbcType=VARCHAR},</if>
<if test="img_url != null"> img_url = #{img_url,jdbcType=VARCHAR},</if>
<if test="memo != null"> memo = #{memo,jdbcType=LONGVARCHAR},</if>
<if test="memo_two != null"> memo_two = #{memo_two,jdbcType=LONGVARCHAR},</if>
<if test="how_learn != null"> how_learn = #{how_learn,jdbcType=VARCHAR},</if>
<if test="baker_name != null"> baker_name = #{baker_name,jdbcType=VARCHAR},</if>
<if test="backer_img_url != null"> backer_img_url = #{backer_img_url,jdbcType=VARCHAR},</if>
<if test="bakers_introduce != null"> bakers_introduce = #{bakers_introduce,jdbcType=VARCHAR},</if>
<if test="price != null"> price = #{price,jdbcType=DOUBLE},</if>
<if test="people_count != null"> people_count = #{people_count,jdbcType=INTEGER},</if>
<if test="add_time != null"> add_time = #{add_time,jdbcType=DATE},</if>
<if test="order_index != null"> order_index = #{order_index,jdbcType=TINYINT},</if>
<if test="state != null"> state = #{state,jdbcType=TINYINT},</if>
<if test="category_id != null"> category_id = #{category_id,jdbcType=INTEGER},</if>
<if test="isindex != null"> isindex = #{isindex,jdbcType=TINYINT},</if>
</set>
 where id = #{id,jdbcType=INTEGER}
</update>

<select id="getBasicById"  resultMap="BaseResultMap" parameterType="java.lang.Integer">
<include refid="Base_Column" />
where course.id = #{id,jdbcType=INTEGER}
</select>

<select id="getDetailById"  resultMap="DetailResultMap" parameterType="java.lang.Integer">
<include refid="Detail_Column" />
where course.id = #{id,jdbcType=INTEGER}
</select>

<select id="count" parameterType="cn.ymt.query.CourseQueryParams" resultType="long">
select count(distinct course.id) from course as course
<where>
<if test="condition != null">(${condition})</if>
</where>
</select>

<select id="getDistinctIds" parameterType="cn.ymt.query.CourseQueryParams" resultType="java.lang.Integer">
select distinct course.id from course as course
<where>
<if test="condition != null">(${condition})</if>
</where>
<if test="recordIndex != null"> limit #{recordIndex,jdbcType=INTEGER},#{pageSize,jdbcType=INTEGER}</if>
</select>

<select id="getSimple" parameterType="cn.ymt.query.CourseQueryParams" resultMap="SimpleResultMap">
<include refid="Simple_Column" />
<where>
<if test="condition != null">(${condition})</if>
<if test="pojos != null">
 and <foreach collection="pojos" open="(" close=")" separator=" or " item="pojo">course.id=#{pojo.id,jdbcType=INTEGER}</foreach>
</if>
<if test="ids != null">
 and <foreach collection="ids" open="(" close=")" separator=" or " item="idTemp">course.id=#{idTemp,jdbcType=INTEGER}</foreach>
</if>
</where>
<if test="orderBy != null"> order by ${orderBy}</if>
<if test="recordIndex != null"> limit #{recordIndex,jdbcType=INTEGER},#{pageSize,jdbcType=INTEGER}</if>
</select>

<select id="getBasic" parameterType="cn.ymt.query.CourseQueryParams" resultMap="BaseResultMap">
<include refid="Base_Column" />
<where>
<if test="condition != null">(${condition})</if>
<if test="pojos != null">
 and <foreach collection="pojos" open="(" close=")" separator=" or " item="pojo">course.id=#{pojo.id,jdbcType=INTEGER}</foreach>
</if>
<if test="ids != null">
 and <foreach collection="ids" open="(" close=")" separator=" or " item="idTemp">course.id=#{idTemp,jdbcType=INTEGER}</foreach>
</if>
</where>
<if test="orderBy != null"> order by ${orderBy}</if>
<if test="recordIndex != null"> limit #{recordIndex,jdbcType=INTEGER},#{pageSize,jdbcType=INTEGER}</if>
</select>

<select id="getDetail" parameterType="cn.ymt.query.CourseQueryParams" resultMap="DetailResultMap">
<include refid="Detail_Column" />
 where course.id in 
(select * from(select distinct course.id from course as course 
<where>
<if test="condition != null">(${condition})</if>
</where>
<if test="recordIndex != null"> limit #{recordIndex,jdbcType=INTEGER},#{pageSize,jdbcType=INTEGER}</if>
) as coursetempTable)
</select>
<!--%%%%%%%%%%%%%%-->
<!--得到首页的六个课程-->
 <select id="getSix" resultMap="SimpleResultMap" parameterType="cn.ymt.query.CourseQueryParams">
  select * from course where
  <if test="category_id != null"> category_id = #{category_id,jdbcType=INTEGER} and </if>
  isindex = 1 limit 4,6
 </select>
 <select id="getFour" resultMap="SimpleResultMap" parameterType="cn.ymt.query.CourseQueryParams">
  select * from course where
  <if test="category_id != null"> category_id = #{category_id,jdbcType=INTEGER} and </if>
   isindex = 1 limit 0,4
 </select>
</mapper>